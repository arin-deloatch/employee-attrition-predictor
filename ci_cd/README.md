# CI/CD Directory

This directory contains scripts and resources for the Continuous Integration (CI) and Continuous Deployment (CD) pipelines for the Employee Attrition Predictor project.

## Overview

The CI/CD pipeline is set up to:
- **Run tests and linting** to ensure code quality.
- **Deploy the model** to Amazon SageMaker using a dynamic model URL generated by the modeling notebook.

## Contents

- **deploy_model.py**  
  This script deploys your trained model to Amazon SageMaker. It retrieves a dynamic model URL from an environment variable (`MODEL_URL`), creates a SageMaker model, configures the endpoint, and deploys the endpoint.

- **run_tests.py**  
  This script contains unit and integration tests to validate that your code works as expected before deployment.

## How It Works

1. **Model URL Management:**  
   After training the model, your modeling notebook writes the dynamic model URL to a file in the default S3 bucket. The CD pipeline then retrieves this file and sets the `MODEL_URL` environment variable, which is used by `deploy_model.py`.

2. **GitHub Actions Integration:**  
   The CI/CD pipelines are configured via GitHub Actions workflows located in the `.github/workflows/` directory:
   - **CI Pipeline (`ci_pipeline.yml`):** Runs tests and linting on push and pull request events.
   - **CD Pipeline (`cd_pipeline.yml`):** Automatically deploys the model when changes are pushed to the `main` branch. The CD pipeline also supports manual triggering via the `workflow_dispatch` trigger.

3. **AWS Learner Lab Compatibility:**  
   The pipeline is designed to work within the constraints of an AWS Learner Lab environment, using the user's default S3 bucket and limited AWS permissions.

## Running Locally

### Testing
To run tests locally, execute:
```bash
python ci_cd/run_tests.py
```

### Deployment
Before deploying, ensure that the `MODEL_URL` environment variable is set. Then, run:
```bash
python ci_cd/deploy_model.py
```

## GitHub Actions

The pipelines are automatically triggered by GitHub Actions based on events (pushes, pull requests) to the repository. To manually trigger the CD pipeline:
1. Go to the **Actions** tab in your repository.
2. Select the "CD Pipeline" workflow.
3. Click on the **Run workflow** button.

## Setup Notes

- **AWS Credentials:**  
  Ensure that AWS credentials (`AWS_ACCESS_KEY_ID`, `AWS_SECRET_ACCESS_KEY`) and the `SAGEMAKER_DEFAULT_BUCKET` are configured in your repository secrets.

- **Dependencies:**  
  All required Python dependencies are listed in the `requirements.txt` file. Make sure to install them before running any scripts:
  ```bash
  pip install -r requirements.txt
  ```
